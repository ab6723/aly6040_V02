---
title: "Module 2 Final Project â€” Milestone 1: EDA"
author: "Abby Bridgers and Justin Ehringhaus"
date: "July 24, 2022"
output:
  html_document: default
bibliography: "references.bib"
nocite: '@*'
---

---

```{r setup, include=FALSE}
# repo: https://github.com/ab6723/aly6040_V02
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(pacman)
p_load(tidyverse)  # usual suite of packages
p_load(ggthemes)   # extra themes
p_load(skimr)      # alternative to summary(), skims dataset: skim()
p_load(VIM)        # visualization of missing values: aggr()
```
---

## Data Preparation

```{r}
wvs <- read_csv("../WVS_Cross-National_Wave_7_csv_v4_0.csv")
```

## Analysis & Interpretation

```{r}
wvs_subset <- 
  wvs %>% 
  select(
    Country = B_COUNTRY_ALPHA,
    Longitude = O1_LONGITUDE,
    Latitude = O2_LATITUDE,
    Age = Q262,
    Income.Group = Q288,
    Ethnic.Group = Q290, # see WVS_codebook.pdf for Q290 coding
    Immigrant = Q263,
    Religion = Q289,
    Marital.Status = Q273,
    Education = Q275,
    Number.Children = Q274,
    Happiness = Q46,
    Health = Q47,
    Political.Engagement = Q209:Q222,
    Ethical.Values = Q177:Q198,
  ) %>% 
  rename(
    Political.Engagement.signing.petitions = Political.Engagement1, #Q209
    Political.Engagement.joining.boycotts = Political.Engagement2, #Q210
    Political.Engagement.attending.demonstrations = Political.Engagement3, #Q211
    Political.Engagement.joining.strikes = Political.Engagement4, #Q212
    Political.Engagement.donating.to.campaigns = Political.Engagement5, #Q213
    Political.Engagement.contacting.gov.officials = Political.Engagement6, #Q214
    Political.Engagement.encouraging.action.others = Political.Engagement7, #Q215
    Political.Engagement.encouraging.voting.others = Political.Engagement8, #Q216
    Political.Engagement.searching.political.info = Political.Engagement9, #Q217
    Political.Engagement.signing.electronic.petitions = Political.Engagement10, #Q218
    Political.Engagement.encouraging.action.others2 = Political.Engagement11, #Q219
    Political.Engagement.organizing.political.events = Political.Engagement12, #Q220
    Political.Engagement.voting.locally = Political.Engagement13, #Q221
    Political.Engagement.voting.nationally = Political.Engagement14, #Q222,
    Ethical.Values.falsely.claim.gov.benefits = Ethical.Values1, #Q177
    Ethical.Values.avoiding.fares.public.transport = Ethical.Values2, #Q178
    Ethical.Values.stealing.property = Ethical.Values3, #Q179
    Ethical.Values.cheating.taxes = Ethical.Values4, #Q180
    Ethical.Values.accepting.bribes.on.duty = Ethical.Values5, #Q181
    Ethical.Values.homosexuality = Ethical.Values6, #Q182
    Ethical.Values.prostitution = Ethical.Values7, #Q183
    Ethical.Values.abortion = Ethical.Values8, #Q184
    Ethical.Values.divorce = Ethical.Values9, #Q185
    Ethical.Values.sex.before.marriage = Ethical.Values10, #Q186
    Ethical.Values.suicide = Ethical.Values11, #Q187
    Ethical.Values.euthanasia = Ethical.Values12, #Q188
    Ethical.Values.beating.wife = Ethical.Values13, #Q189
    Ethical.Values.beating.children = Ethical.Values14, #Q190
    Ethical.Values.violence.others = Ethical.Values15, #Q191
    Ethical.Values.terrorism = Ethical.Values16, #Q192
    Ethical.Values.casual.sex = Ethical.Values17, #Q193
    Ethical.Values.political.violence = Ethical.Values18, #Q194
    Ethical.Values.death.penalty = Ethical.Values19, #Q195
    Ethical.Values.government.public.video.surveillance = Ethical.Values20, #Q196
    Ethical.Values.government.monitoring.internet.emails = Ethical.Values21, #Q197
    Ethical.Values.government.discretely.collecting.info.on.citizens = Ethical.Values22, #Q198
  )
```

```{r}
skim(wvs_subset)
```

...Write about observations of the skim here...

```{r}
# Testing this... not working, but just an idea for long/lat values
p_load(maps)
map("world")
points(wvs_subset$Latitude, wvs_subset$Longitude, col = "red", pch = ".", cex = 2)
```

```{r}
Religion.names <- c('No Religion', 'Roman Catholic', 'Protestant', 'Orthodox',
                    'Jew', 'Muslim', 'Hindu', 'Buddhist', 'Other Christian', 'Other')

wvs_subset %>% 
  ggplot +
  aes(x = as.factor(Number.Children), fill = as.factor(Religion)) +
  geom_bar(position = "fill") +
  scale_fill_discrete(name = "Religious Denomination",
                      labels = Religion.names) +
  xlab("Number of Children") +
  ylab("Proportion") +
  theme_tufte()
```

- For almost all counts of children, Muslims proportionally dominate other religious denominations.
- Those without a religion generally have less, rather than more, children.
- It appears outliers are present, such as families with 12+ children, this can be checked by running:

```{r}
table(wvs_subset$Number.Children, wvs_subset$Religion)
```




---

## TASKS

- Calculate appropriate summary statistics
- Create appropriate graphs that will give you insights into the data.

Include the answers to following questions:

- What did you do with the data in the context of exploration?
- How many entries are in the dataset?
- Was there missing data? Duplications? How clean was the data?
- Were their outliers or suspicious data?
- What did you do to clean the data?
- What did you find? What intrigued you about the data? Why does that matter?
- What would your proposed next steps be?
- What business questions do you plan to answer with your data mining?